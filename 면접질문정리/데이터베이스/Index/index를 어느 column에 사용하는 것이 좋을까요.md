# Q. index를 어느 column에 사용하는 것이 좋을까요?

[답변]

index는 where절에서 자주 조회되고, 수정 빈도가 낮으며, 카디널리티는 높고, 선택도가 낮은 column을 선택해서 설정하는 것이 가장 좋습니다.

-   카디널리티란, 데이터가 중복되지 않는 정도
-   선택도는 데이터에서 특정 값을 잘 골라낼 수 있는 정도(선택도가 1이면 모든 데이터가 유니크함을 의미)

| 기준        | 적합성                                         |
| ----------- | ---------------------------------------------- |
| 카디널리티  | 높을수록 적합(데이터 중복이 적을수록 적합)     |
| 선택도      | 낮을수록 적합                                  |
| 조회 활용도 | 높을수록 적합 (where절에서 많이 사용되면 적합) |
| 수정빈도    | 낮을수록 적합                                  |

[TIP]

> index를 어떤 column에 대해서 생성하는 것이 좋을지에 대한 판단 근거를 물어보는 면접 질문입니다. DB질문으로 거의 무조건 나오는 질문입니다. 굉장히 중요하지만 내용은 그렇게 어렵지 않습니다.

> index를 사용하면 검색속도를 높이지만 추가 저장공간을 차지하고 데이터 업데이트 시 속도가 느려지게 됩니다. 따라서 어떤 column에 index를 생성해야 되는지를 잘 학습하시기 바랍니다. 특히 몇가지 예를 가져와서 이 경우에는 index 적용하는게 좋을까요? 안좋을까요? 라고 추가 질문을 종종합니다.

## Index를 효과적으로 사용하는 방법

-   SELECT WHERE절에 자주 사용되는 Column에 대해 index를 생성하는 것이 좋습니다.
-   데이터 수정 빈도가 낮을수록 적합합니다. insert / update / delete 작업 시, 데이터에 변화가 생기기 때문에 index에서는 매번 정렬을 다시 해야합니다. 이에 따른 부하가 발생하기 때문에 수정 빈도가 낮은 column을 index로 설정하면 좋습니다.
-   데이터의 중복이 높은 column은 index 효과가 별로 없습니다. 예를 들어 성별은 종류가 2가지 밖에 없으므로 index를 생성하지 않는 것이 좋습니다. 즉, 선택도가 낮을 때 유리합니다. (보통 5 ~ 10%이내)
-   데이터의 양이 많을수록 index로 인한 성능향상이 더 큽니다. 데이터 양이 적다면 index의 혜택보단 손해가 더 클 수 있습니다.
-   Join 조건으로 자주 사용되는 column의 경우
-   한 table에 index가 너무 많으면 데이터 수정 시 소요되는 시간이 너무 길어질 수 있습니다. (table 당 4 ~ 5개 정도 권장)

### Q. index를 쓰면 성능이 좋아지니까 모든 컬럼에 인덱스를 사용하면 성능이 더 좋겠네요?

[답변]

그렇지 않습니다. 일단 index는 SELECT WHERE절에 대해서만 성능향상을 해줍니다. 이외에 데이터를 수정하게 되면 모든 index를 업데이트(+정렬)해야 하기 때문에 오히려 성능저하를 초래합니다. 또한 index를 생성할 때 마다 저장공간도 차지하기 때문에 무분별하게 생성해서는 안됩니다.

### Q. 우리 회사의 고객 DB에서 성별 column에 index를 걸어주는게 좋을까요?

[답변]

성별처럼 남녀 두 종류로만 나눠지는 경우에는 카디널리티가 매우 낮고, 선택도는 매우 높게 됩니다. 이 경우, index가 주는 이점이 매우 적고 오히려 저장공간 차지와 데이터 수정시 성능 저하등을 고려하여 index를 생성하지 않는 것이 좋습니다.

### Q. true또는 false 값을 갖는 column에서, true 1%, false 99%의 비율로 구성된 상황에서는 index를 거는게 좋을까요?

[답변]

아무리 1%, 99%로 비율이 차이가 있어도, true/false 두 종류로만 나눠지는 경우에는 카디널리티가 매우 낮고, 선택도는 매우 높게 됩니다. 이 경우, index가 주는 이점이 매우 적고 오히려 저장공간 차지와 데이터 수정시 성능 저하등을 고려하여 index를 생성하지 않는 것이 좋습니다.
