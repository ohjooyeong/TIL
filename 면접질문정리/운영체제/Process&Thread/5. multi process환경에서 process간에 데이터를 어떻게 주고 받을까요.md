# Q. multi process환경에서 process간에 데이터를 어떻게 주고 받을까요?

[답변]

원칙적으로 process는 독립적인 주소 공간을 갖기 때문에, 다른 process의 주소 공간을 참조할 수 없습니다. 하지만 경우에 따라 운영체제는 process간의 자원 접근을 위한 매커니즘인 프로세스 간 통신(IPC, Inter Porcess Communication)를 제공합니다.

프로세스 간 통신(IPC) 방법으로는 파이프, 파일, 소켓, 공유메모리 등을 이용한 방법이 있습니다.

[TIP]

> IPC는 면접에서도 굉장히 자주 나오는 질문입니다. multi thread와 다르게 process끼리는 데이터 공유를 하고 있지 않습니다. 따라서 데이터를 주고 받기 위해서 IPC기법을 사용합니다. IPC는 크게 공유메모리 방식과 메시지 전달방식으로 나뉘는데 이 둘의 장단점과 차이점을 중심으로 공부해가시길 바랍니다.

## IPC (Inter Porcess Communication)

process는 각자 자신만의 독립적인 주소공간을 가지는데, 다른 process가 이 주소공간을 참조하는 것은 허용하지 않습니다. 그렇기 때문에 다른 process와 데이터를 주고받을 수 없습니다. 이를 해결하고자 운영체제는 IPC기법을 통해 process들 간에 통신을 가능하게 해줍니다.

process간 통신(IPC)에는 기본적으로 공유메모리(shared memory)와 메시지 전달(message passing)의 두가지 모델이 있습니다.

### 공유메모리(shared memory)

공유 메모리 방식에서는 process들이 주소 공간의 일부를 공유합니다. 공유한 메모리 영역에 읽기/쓰기를 통해서 통신을 수행합니다. process가 공유 메모리 할당을 커널에 요청하면 커널은 해당 프로세스에 메모리 공간을 할당해줍니다. 공유 메모리 영역이 구축된 이후에는 모든 접근이 일반적인 메모리 접근으로 취급되기 때문에 더이상 커널의 도움없이도 각 프로세스들이 해당 메모리 영역에 접근할 수 있습니다. 따라서 커널의 관여없이 데이터를 통신할 수 있기 때문에 IPC속도가 빠르다는 장점이 있습니다.

공유 메모리 방식은 프로세스간의 통신을 수월하게 만들지만 동시에 같은 메모리 위치에 접근하게 되면 일관성 문제가 발생할 수 있습니다. 이에 대해서는 커널이 관여하지 않기 때문에 프로세스들끼리 직접 공유 메모리 접근에 대한 동기화 문제를 책임져야 합니다.

### 메시지 전달(message passing)

메시지 전달 방법은 통상 system call을 사용하여 구현됩니다. 커널을 통해 send(message)와 receive(message)라는 두가지 연산을 제공받습니다. 예를 들면, process1이 커널로 message를 보내면 커널이 process2에게 message를 보내주는 방식으로 동작합니다.

메모리 공유보다는 속도가 느리지만, 충돌을 회피할 필요가 없기 때문에 적은 양의 데이터를 교환하는데 유용합니다. 또, 구현하기가 쉽다는 장점이 있습니다.

대표적인 예시로는 pipe, socket, message queue 등이 있습니다.

> system call: 프로세스가 커널에게 요청하는 것

### Q. IPC의 예시를 들어주실 수 있나요?

[답변]

IPC는 크게 공유 메모리 모델과 메시지 전달 모델로 나눌 수 있습니다. 공유 메모리 모델은 주소 공간의 일부를 공유한 메모리 영역에 read/write를 통해 통신하게 되는데, 예시로는 공유메모리와 POSIX가 있습니다. 메시지 전송 모델의 경우에는 커널을 통해 send/receive 연산을 통해 데이터를 전송합니다. 예시로는 pipe, socket, message queue 등이 있습니다.

### Q. 공유메모리와 메시지 전달 모델의 장단점을 설명해주세요.

[답변]

공유 메모리 모델은 초기에 공유 메모리 할당을 제외하면 커널의 관여없이 통신할 수 있기 때문에 속도가 빠른 장점이 있습니다. 하지만 여러 프로세스가 동시에 메모리에 접근하는 문제가 발생할 수 있어서 별도의 동기화 과정이 필요하다는 단점이 있습니다.

메시지 전달 모델은 커널을 통해서 데이터를 주고받기 때문에 통신 속도가 느리다는 단점이 있습니다. 커널에서 제어를 해주기 때문에 안전하며 커널이 동기화를 제공해준다는 장점이 있습니다.
